<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
		<title>Editar a lista de contratos</title>
		<style>
			body {
				max-width: 1000px;
				margin: auto;
			}
		</style>
		<script>
			function go() {
				document.getElementById('return_area').value = '';
				
				let main_text = document.getElementById('copied_area').value;
				
				let re_extra_date = /Relatório Emitido em.*\n/g;
				main_text = main_text.replace(re_extra_date, '');
				
				let groups = main_text.split('Lota');
				
				for (let i = 0; i < groups.length - 1; i++) {
					let re_datas = /\d{2}\/\d{2}\/\d{4}/g;
					let datas = groups[i].match(re_datas);
					
					let re_portaria = /Nr.:\s(\d*)/g;
					let portaria = groups[i].match(re_portaria);
					
					let txt_portaria = '';
					
					if (portaria === null) {
						txt_portaria = ' (Sem portaria)';
					} else {
						txt_portaria = ' (Portaria ' + portaria[0].replace('Nr.: ', '') + ' de ' + datas[2] + ')';
					}
					document.getElementById('return_area').value += "x. Vínculo: Tempo de Serviço Público Estadual - Professor\nÓrgão de lotação: Secretaria de Estado da Educação\nInício: " + datas[0] + txt_portaria + '\nFim: ' + datas[1] + txt_portaria + '\nRegime de Trabalho: Estatutário/Celetista\nRegime Previdenciário: RPPS/RGPS\n\n';
				}
			}
		</script>
	</head>
	<body>
		<h2>Texto original:</h2>
		<textarea rows="8" cols="100" onkeyup="go();" id="copied_area"></textarea>
		<h2>Texto formatado:</h2>
		<textarea rows="14" cols="100" id="return_area"></textarea>
</body>

</html> 
